/* Generated By:JJTree: Do not edit this line. COOLTemplateRHSPattern.java */
package org.jamocha.parser.cool;

import org.jamocha.parser.EvaluationException;
import org.jamocha.parser.JamochaValue;
import org.jamocha.rete.Deffact;
import org.jamocha.rete.Deftemplate;
import org.jamocha.rete.Rete;
import org.jamocha.rete.Slot;

public class COOLTemplateRHSPattern extends SimpleNode {
    public COOLTemplateRHSPattern(int id) {
	super(id);
    }

    public COOLTemplateRHSPattern(COOLParser p, int id) {
	super(p, id);
    }

    public JamochaValue getValue(Rete engine) throws EvaluationException {
	Deffact fact;
	int i;
	Slot[] slots = new Slot[jjtGetNumChildren()];
	// Execute children, build fact from return values (RHSPatterns return
        // slots!!)
	for (i = 0; i < jjtGetNumChildren(); i++)
	    slots[i] = jjtGetChild(i).getValue(engine).getSlotValue();
	Deftemplate tmpl = (Deftemplate) engine.getCurrentFocus().getTemplate(name);
	fact = (Deffact) tmpl.createFact(slots, -1, engine);
	return JamochaValue.newFact(fact);
    }

}
